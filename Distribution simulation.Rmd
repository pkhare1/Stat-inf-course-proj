---
title: "Distribution simulation"
author: "Pratik A. Khare"
date: "2025-11-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Simulation Exercise

In this project you will investigate the exponential distribution in R and compare it with the Central Limit Theorem. The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda. Set lambda = 0.2 for all of the simulations. You will investigate the distribution of averages of 40 exponentials. Note that you will need to do a thousand simulations.

Illustrate via simulation and associated explanatory text the properties of the distribution of the mean of 40 exponentials. You should

1. Show the sample mean and compare it to the theoretical mean of the distribution.

```{r, echo=TRUE}
means<-numeric(length(1000)) #Initialize the array "means"
for (i in 1:1000) { #loop through 1000 times for generating the rexp function
  expfunc <- rexp(40,0.2) #n=40, lambda=0.2
  means[i] <- mean(expfunc) #store the means of each of the iterations in the array "means"
}
sampmean <- mean(means) #The mean of all means in our sample mean
hist(means,freq=FALSE) #Plot histogram of the sample means. freq=FALSE displays the density instead of discrete counts
lines(density(means),col="red",lwd=2) #overlay the density curve atop it

curve(dnorm(x, mean=5, sd=5/sqrt(40)), add=TRUE, col="blue", lwd=2)
legend("topright", c("Sample distribution", "Theoretical distribution"), 
       col = c("red", "blue"), lwd = 2)
```

Sample mean = `r sampmean` and theoretical mean = 5.

As seen in this plot, which compares the sample distribution and the theoretical distribution, the sample and theoretical means are very similar (close to 5)

2. Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.

```{r, echo=TRUE}
sampvan<-numeric(length(1000))
for (j in 1:length(means)) {
  sampvan[j] <- (means[j] - mean(means))^2
}

sampvance <- sum(sampvan)/(length(sampvan)-1)
theovance <- ((1/0.2)^2)/40
```

Similarly, the sample variance is `r sampvance` and the theoretical variance is `r theovance` which again, are very similar

3. Show that the distribution is approximately normal.

To show this, let us compare how the distribution of a n=1000 exponential function looks like versus a simulation of the mean of 1000 n=40 exponential functions.

```{r, echo=TRUE}
hist(rexp(1000, 0.2))
```

```{r, echo=TRUE}
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40,0.2)))
hist(mns, main="Histogram of 1000 n=40, lambda=0.2 exponentials",freq=FALSE)
lines(density(means),col="red",lwd=2) #overlay the density curve atop it

curve(dnorm(x, mean=5, sd=5/sqrt(40)), add=TRUE, col="blue", lwd=2)
legend("topright", c("Sample distribution", "Theoretical distribution"), 
       col = c("red", "blue"), lwd = 2)
```

This clearly shows that the latter is a normal distribution centered about 5. Moreover upon overlaying this with a normal distribution centered about 5 and having a std dev of 5/sqrt(40) proves that the distribution of 1000 n=40, lambda=0.2 exponentials is approximately normal.